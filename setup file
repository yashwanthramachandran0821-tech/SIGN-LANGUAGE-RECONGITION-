import os
import sys
import subprocess
import platform

def check_and_install():
    """Check and install required packages"""
    print("ğŸš€ Setting up Sign Language Translator...")
    
    # Create directories
    directories = [
        'models',
        'data/train',
        'data/test',
        'static/css',
        'static/js',
        'templates',
        'utils'
    ]
    
    for directory in directories:
        os.makedirs(directory, exist_ok=True)
        print(f"ğŸ“ Created directory: {directory}")
    
    # Check Python version
    python_version = platform.python_version()
    print(f"ğŸ Python version: {python_version}")
    
    if sys.version_info < (3, 8):
        print("âŒ Python 3.8 or higher is required")
        sys.exit(1)
    
    # Install requirements
    print("ğŸ“¦ Installing dependencies...")
    try:
        subprocess.check_call([sys.executable, "-m", "pip", "install", "-r", "requirements.txt"])
        print("âœ… Dependencies installed successfully!")
    except subprocess.CalledProcessError:
        print("âŒ Failed to install dependencies")
        print("ğŸ“‹ Please run: pip install -r requirements.txt")
        sys.exit(1)
    
    # Download sample data if needed
    download_sample_data()
    
    print("\nğŸ‰ Setup completed successfully!")
    print("\nğŸ“– To run the application:")
    print("1. ğŸ‹ï¸â€â™‚ï¸ Train the model: python train_model.py")
    print("2. ğŸŒ Start web app: python app.py")
    print("3. ğŸ“± Start API server: python api.py")
    print("4. ğŸ¥ Real-time detection: python realtime_detector.py")

def download_sample_data():
    """Download sample ASL dataset"""
    import urllib.request
    import zipfile
    
    # URL for sample ASL dataset (small version)
    sample_url = "https://github.com/loicmarie/sign-language-digits-dataset/archive/refs/heads/master.zip"
    
    print("ğŸ“¥ Downloading sample dataset...")
    try:
        urllib.request.urlretrieve(sample_url, "sample_data.zip")
        with zipfile.ZipFile("sample_data.zip", 'r') as zip_ref:
            zip_ref.extractall("data/")
        os.remove("sample_data.zip")
        print("âœ… Sample dataset downloaded!")
    except:
        print("âš ï¸ Could not download sample data. Using synthetic data for training.")

if __name__ == "__main__":
    check_and_install()
